#!/bin/bash

cat << 'EOF'
MEMORY LEARNING PROTOCOL

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STEP 0: Memory 컨텍스트 확인
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Hook에서 자동 주입된 컨텍스트를 확인하세요.

**<memory-context> 태그가 있으면:**
→ 유사도 충분 (>= 65%)
→ 주입된 컨텍스트로 바로 작업 진행

**<memory-learning-required> 태그가 있으면:**
→ 유사도 부족 (< 65%)
→ memory-learner 서브에이전트 호출 필수!

```
Task(
  subagent_type="memory-learner",
  prompt="""
  **사용자 요청**: {원본 요청}
  **트리거 이유**: low_similarity
  **키워드**: {요청에서 추출한 키워드}
  """
)
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STEP 1: 작업 실행
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

주입된 Memory 컨텍스트를 활용하여 사용자 요청을 처리합니다.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STEP 2: Learning Capture (필수!)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**작업 중 아래 상황 발생 시 learnings.md에 기록:**

| 상황 | type | 예시 |
|------|------|------|
| 코드베이스에서 새 정보 발견 | `new` | Entity 구조, 비즈니스 로직 |
| 사용자가 오류 지적 | `correction` | "그거 틀렸어" → 올바른 정보 |
| Memory와 코드가 다름 | `outdated` | Memory엔 A, 코드엔 B |
| 사용자가 규칙 설명 | `new` | "우리는 이렇게 해" |

**기록 형식:**
```markdown
### [YYYY-MM-DDTHH:MM:SS]
**type**: new | correction | outdated
**confidence**: high | medium | low

#### Content
- 학습한 내용

#### Context
어떤 상황에서 발견했는지
```

**<memory-flush-suggested> 태그가 있으면:**
→ `/memory-commit` 실행하여 Memory에 반영

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
STEP 3: 응답 완료
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

사용자에게 결과 전달 후, 다음 요청 대기.
→ STEP 0으로 돌아감 (루프)

EOF
